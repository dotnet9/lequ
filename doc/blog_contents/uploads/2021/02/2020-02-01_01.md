C/S客户端开发完成，需要将程序交付给用户，直接压缩发给用户是可以的（只是有点不专业），如果能有一个比较好看的安装界面，那档次就不一样了。

本文介绍怎么使用Adanced Installer 17.9 制作专业的Windows 客户端安装包，其他软件或者本软件其他版本制作步骤也是类似的，下面是软件安装包制作完成后的安装演示：

软件安装演示

![软件安装演示](https://img1.lequ.co/2021/02/0401.gif)

本文提供打包的程序源码下载及制作好的软件安装包体验，欢迎浏览下载：

- 制作好的软件安装包：[下载测试安装包](https://github.com/dotnet9/lqclass.com/releases/tag/0.5.0)
- 测试打包的项目仓库：[访问项目源码](https://github.com/dotnet9/lqclass.com)

**下面介绍安装包制作步骤：**

## 1、下载Adanced Installer 17.9

首先下载软件安装包制作软件，安装包从360软件管家下载，其他途径亦可：

下载安装包制作软件

![下载安装包制作软件](https://img1.lequ.co/2021/02/0402.png)

下载后，按默认步骤安装即可。

## 2、创建安装包制作工程

制作软件安装包与软件开发一样，我们先创建一个安装包制作工程，相当于保存安装包配置的过程，方便以后再次修改、打包：

![创建软件安装包配置工程](https://img1.lequ.co/2021/02/0403.png)

## 3、安装包产品信息

- 填写程序释放的目录名称：乐趣课堂
- 填写公司名称，和程序释放的目录名称组成安装路径：Dotnet9

比如默认安装后的路径为：C:\Program Files (x86)\Dotnet9\乐趣课堂，安装的时候路径是可以修改。

![安装包产品信息](https://img1.lequ.co/2021/02/0404.png)

## 4、输入安装参数

应用程序的文件夹，可以不用修改，默认即可：

![安装参数](https://img1.lequ.co/2021/02/0405.png)

## 5、选择程序运行环境

打包的测试程序([访问乐趣课堂源码仓库](https://github.com/dotnet9/lqclass.com))依赖.NET 5运行时（发布时选择的依赖于环境），所以在下面的配置里可以选择安装时下载、安装.NET 5运行时（独立发布可以忽略这个步骤）：

![程序运行环境配置](https://img1.lequ.co/2021/02/0406.png)

## 6、设置程序启动条件

看下面的界面，选择程序可运行的操作系统，分x86和x64各版本Windows操作系统：

![设置启动条件](https://img1.lequ.co/2021/02/0407.png)

## 7、选择安装文件

下面是目标程序目录结构结构，即待打包的目录，运行程序和依赖文件都在这个文件夹中：

乐趣课堂的程序输出目录文件一览

![乐趣课堂的程序输出目录文件一览](https://img1.lequ.co/2021/02/0408.png)

在软件安装包制作界面，添加应用程序的文件（夹），即选择上面的文件夹，注：子目录和文件需要分别选择。

选择程序包文件菜单

![选择程序包文件菜单](https://img1.lequ.co/2021/02/0409.png)

添加后，软件安装包制作界面的目录如下，中间显示添加的各子目录，右侧显示Application Folder目录下文件：

选择后的文件结构

![选择后的文件结构](https://img1.lequ.co/2021/02/0410.png)

## 8、添加快捷方式

正常程序，需要在开始菜单和桌面添加程序的快捷方式，如下图：

开始菜单快捷方式

![开始菜单快捷方式](https://img1.lequ.co/2021/02/0411.png)

桌面快捷方式

![桌面快捷方式](https://img1.lequ.co/2021/02/0412.png)

完成上面的效果，简单需求：

- 开始菜单添加程序目录：在【Start Menu】=>【Programs】下添加子文件夹【乐趣课堂】（改成你自己程序的名称）
- 开始菜单程序目录需要添加启动程序快捷方式、卸载程序快捷方式
- 桌面添加启动程序快捷方式

### 8.1 添加快捷启动方式

如下图，选中中间的”乐趣课堂“目录（`Desktop`目录操作同理），右侧右键菜单从安装程序添加快捷方式：

从安装文件中选择启动的程序

![从安装文件中选择启动的程序](https://img1.lequ.co/2021/02/0413.png)

下图出现了选择文件列表，需要在前面的第7步中选择了文件才会出现，`LQClass.AdminForWPF.exe` 是主程序的exe，将它作为开始菜单、桌面的启动程序快捷方式：

选择程序作为启动程序快捷方式

![选择程序作为启动程序快捷方式](https://img1.lequ.co/2021/02/0414.png)

### 8.2 添加卸载快捷方式

我看大部分程序开始菜单都没添加卸载快捷方式，不过我们自信，添加上去吧，用户想卸就卸：

添加卸载快捷方式

![添加卸载快捷方式](https://img1.lequ.co/2021/02/0415.png)

下面弹出的卸载快捷方式编辑界面，可以不用修改，如果不想显示程序版本号，去掉也无妨：“卸载[ProductName]”显示效果为“卸载乐趣课堂”：

弹出卸载快捷方式编辑

![弹出卸载快捷方式编辑](https://img1.lequ.co/2021/02/0416.png)

## 9、设置打包文件输出格式

如图中备注，选择第四个，在运行软件安装包时，可在线下载、安装运行时，可修改MSI安装文件的名字和EXE安装文件的名字：

![打包文件输出格式](https://img1.lequ.co/2021/02/0417.png)

## 10、配置安装界面主题风格

该软件提供的主题风格很多，站长浏览了一遍，图中的效果比较清爽，看个人喜欢选择：

![安装程序主题](https://img1.lequ.co/2021/02/0418.png)

## 11、设置界面语言包

默认简体中文：

![语言包配置](https://img1.lequ.co/2021/02/0419.png)

## 12、前面的配置差不多了，该浏览安装效果了

安装的每一步都可以看看效果：

![安装步骤浏览](https://img1.lequ.co/2021/02/0420.png)

## 13、构建、运行

就像编程一样，前面的只是代码编写，一个简单功能完成，需要执行代码编译，生成可执行文件，制作软件安装包也是一样，先执行构建，然后就可以点击Run进行安装测试了，见开头的安装运行动画：

![构建运行菜单](https://img1.lequ.co/2021/02/0421.png)

构建后产生的文件如下，下面的文件名在第9步中可以修改，当然你现在也可以手动修改：

![安装包文件](https://img1.lequ.co/2021/02/0422.png)

好了，安装包制作完成，有什么问题欢迎留言交流。

参考文章：
- [Advanced Installer 11.0实战教程](https://blog.csdn.net/neweastsun/article/details/43729983)
- [Advanced Installer 在开始菜单添加卸载选项及设置桌面快捷方式](http://www.360doc.com/showweb/0/0/960057626.aspx)